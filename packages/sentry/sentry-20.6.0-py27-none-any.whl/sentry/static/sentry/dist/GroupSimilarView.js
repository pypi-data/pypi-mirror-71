(window.sntryWpJsonp=window.sntryWpJsonp||[]).push([[85],{1684:function(e,t,r){"use strict";var n=r(5),i=r.n(n),a=r(15),s=r.n(a),o=r(8),c=r.n(o),l=r(9),u=r.n(l),g=r(11),f=r.n(g),d=r(12),p=r.n(d),m=r(6),h=r.n(m),b=r(2),y=r.n(b),v=r(45),O=r.n(v),j=r(284),S=r(0);function I(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var k=function(e){f()(n,e);var t,r=(t=n,function(){var e,r=h()(t);if(I()){var n=h()(this).constructor;e=Reflect.construct(r,arguments,n)}else e=r.apply(this,arguments);return p()(this,e)});function n(){return c()(this,n),r.apply(this,arguments)}return u()(n,[{key:"render",value:function(){var e=this.props,t=e.className,r=e.disabled,n=e.title,a=e.children,o=s()(e,["className","disabled","title","children"]);return Object(S.f)(j.a,i()({},o,{disabled:r}),Object(S.f)("a",{href:"#",className:O()(t||"",{disabled:r}),title:n},a))}}]),n}(y.a.PureComponent);k.displayName="LinkWithConfirmation",t.a=k},1891:function(e,t,r){"use strict";var n=r(5),i=r.n(n),a=r(15),s=r.n(a),o=(r(2),r(45)),c=r.n(o),l=r(0),u=function(e){var t=e.responsive,r=void 0!==t&&t,n=e.center,a=void 0===n||n,o=e.children,u=e.className,g=s()(e,["responsive","center","children","className"]),f=c()("spread-layout",u,{center:a,"allow-responsive":r});return Object(l.f)("div",i()({},g,{className:f}),o)};u.displayName="SpreadLayout",t.a=u},1893:function(e,t,r){"use strict";var n=r(17),i=r.n(n),a=r(29),s=r.n(a),o=r(43),c=r.n(o),l=r(21),u=r.n(l),g=r(337),f=r.n(g),d=r(54),p=r(31),m=r(1949);function h(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var b=new d.a,y=u.a.createStore({listenables:[m.a],init:function(){var e=this,t=this.getInitialState();Object.entries(t).forEach((function(t){var r=c()(t,2),n=r[0],i=r[1];e[n]=i}))},getInitialState:function(){return{mergedItems:[],unmergeList:new Map,unmergeState:new Map,unmergeDisabled:!0,unmergeLastCollapsed:!1,enableFingerprintCompare:!1,similarItems:[],filteredSimilarItems:[],similarLinks:"",mergeState:new Map,mergeList:new Set,mergedLinks:"",mergeDisabled:!1,loading:!0,error:!1}},setStateForId:function(e,t,r){return(Array.isArray(t)?t:[t]).map((function(t){var n=e.has(t)&&e.get(t)||{},i=Object.assign({},n,r);return e.set(t,i),i}))},isAllUnmergedSelected:function(){var e=Array.from(this.unmergeState.values()).filter((function(e){return e.busy}))||[];return this.unmergeList.size===this.mergedItems.filter((function(e){return!!e.latestEvent})).length-e.length},onFetch:function(e){var t=this,r=e||this.toFetchArray;this.init(),this.triggerFetchState();var n=r.map((function(e){var t=e.endpoint,r=e.queryParams,n=e.dataKey;return new Promise((function(e,i){b.request(t,{method:"GET",data:r,success:function(t,r,i){e({dataKey:n,data:t,links:i.getResponseHeader("Link")})},error:function(e){var t=e.responseJSON&&e.responseJSON.detail||!0;i(t)}})}))})),i={merged:function(e){return t.setStateForId(t.unmergeState,e.id,{busy:"locked"===e.state}),e},similar:function(e){var t,r=c()(e,2),n=r[0],i=r[1],a=!((t=i)&&Object.keys(t)||[]).map((function(e){return t[e]})).find((function(e){return e>=.6})),s=Object.keys(i).map((function(e){return[e,i[e]]})).reduce((function(e,t){var r=c()(t,2),n=r[0],i=r[1],a=n.split(":"),s=c()(a,1)[0];return e[s]||(e[s]=[]),e[s].push([n,i]),e}),{}),o=Object.keys(s).map((function(e){return[e,s[e]]})).reduce((function(e,t){var r=c()(t,2),n=r[0],i=r[1].filter((function(e){return null!==c()(e,2)[1]})),a=i.reduce((function(e,t){return e+c()(t,2)[1]}),0)/i.length;return e[n]=a,e}),{});return{issue:n,score:i,scoresByInterface:s,aggregate:o,isBelowThreshold:a}}};return e&&(this.toFetchArray=e),Promise.all(n).then((function(e){e.forEach((function(e){var r=e.dataKey,n=e.data,a=e.links,s=n.map(i[r]);t["".concat(r,"Items")]=s,t["".concat(r,"Links")]=a})),t.loading=!1,t.error=!1,t.triggerFetchState()}),(function(){t.loading=!1,t.error=!0,t.triggerFetchState()}))},onToggleMerge:function(e){var t,r=this.mergeState.has(e)&&this.mergeState.get(e);r&&!0===r.busy||(this.mergeList.has(e)?(this.mergeList.delete(e),t=!1):(this.mergeList.add(e),t=!0),this.setStateForId(this.mergeState,e,{checked:t}),this.triggerMergeState())},onToggleUnmerge:function(e){var t,r=c()(e,2),n=r[0],i=r[1],a=this.unmergeState.get(n);a&&!0===a.busy||(this.unmergeList.has(n)?(this.unmergeList.delete(n),t=!1):(this.unmergeList.set(n,i),t=!0),this.setStateForId(this.unmergeState,n,{checked:t}),this.unmergeDisabled=0===this.unmergeList.size||this.isAllUnmergedSelected(),this.enableFingerprintCompare=2===this.unmergeList.size,this.triggerUnmergeState())},onUnmerge:function(e){var t=this,r=e.groupId,n=e.loadingMessage,i=e.successMessage,a=e.errorMessage,s=Array.from(this.unmergeList.keys());return new Promise((function(e,o){t.isAllUnmergedSelected()?o(new Error("Not allowed to unmerge ALL events")):(t.unmergeDisabled=!0,t.setStateForId(t.unmergeState,s,{checked:!1,busy:!0}),t.triggerUnmergeState(),Object(p.b)(n),b.request("/issues/".concat(r,"/hashes/"),{method:"DELETE",query:{id:s},success:function(){Object(p.d)(i),t.setStateForId(t.unmergeState,s,{checked:!1,busy:!0}),t.unmergeList.clear()},error:function(){Object(p.a)(a),t.setStateForId(t.unmergeState,s,{checked:!0,busy:!1})},complete:function(){t.unmergeDisabled=!1,e(t.triggerUnmergeState())}}))}))},onMerge:function(e){var t=this,r=e.params,n=e.query,i=e.projectId,a=Array.from(this.mergeList.values());return this.mergeDisabled=!0,this.setStateForId(this.mergeState,a,{busy:!0}),this.triggerMergeState(),new Promise((function(e){if(r){var o=r.orgId,c=r.groupId;b.merge({orgId:o,projectId:i||r.projectId,itemIds:[].concat(s()(a),[c]),query:n},{success:function(e){e&&e.merge&&e.merge.parent&&t.trigger({mergedParent:e.merge.parent}),t.setStateForId(t.mergeState,a,{checked:!1,busy:!0}),t.mergeList.clear()},error:function(){t.setStateForId(t.mergeState,a,{checked:!0,busy:!1})},complete:function(){t.mergeDisabled=!1,e(t.triggerMergeState())}})}else e(null)}))},onToggleCollapseFingerprints:function(){this.setStateForId(this.unmergeState,this.mergedItems.map((function(e){return e.id})),{collapsed:!this.unmergeLastCollapsed}),this.unmergeLastCollapsed=!this.unmergeLastCollapsed,this.trigger({unmergeLastCollapsed:this.unmergeLastCollapsed,unmergeState:this.unmergeState})},onToggleCollapseFingerprint:function(e){var t=this.unmergeState.has(e)&&this.unmergeState.get(e).collapsed;this.setStateForId(this.unmergeState,e,{collapsed:!t}),this.trigger({unmergeState:this.unmergeState})},triggerFetchState:function(){var e=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?h(Object(r),!0).forEach((function(t){i()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({similarItems:this.similarItems.filter((function(e){return!e.isBelowThreshold})),filteredSimilarItems:this.similarItems.filter((function(e){return e.isBelowThreshold}))},f()(this,["mergedItems","mergedLinks","similarLinks","mergeState","unmergeState","loading","error"]));return this.trigger(e),e},triggerUnmergeState:function(){var e=f()(this,["unmergeDisabled","unmergeState","unmergeList","enableFingerprintCompare","unmergeLastCollapsed"]);return this.trigger(e),e},triggerMergeState:function(){var e=f()(this,["mergeDisabled","mergeState","mergeList"]);return this.trigger(e),e}});t.a=y},1922:function(e,t,r){"use strict";var n=r(5),i=r.n(n),a=r(29),s=r.n(a),o=r(8),c=r.n(o),l=r(9),u=r.n(l),g=r(11),f=r.n(g),d=r(12),p=r.n(d),m=r(6),h=r.n(m),b=r(4),y=r(2),v=r.n(y),O=r(26),j=r(0);function S(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var I=function(e){f()(n,e);var t,r=(t=n,function(){var e,r=h()(t);if(S()){var n=h()(this).constructor;e=Reflect.construct(r,arguments,n)}else e=r.apply(this,arguments);return p()(this,e)});function n(){return c()(this,n),r.apply(this,arguments)}return u()(n,[{key:"render",value:function(){var e=this.props,t=e.className,r=e.vertical,n=e.palette,a=e.score,o=e.size,c=e.thickness,l=e.radius,u=n.length,g=a>=u?u:a<=0?0:a,f=g-1,d={vertical:r,thickness:c,size:o,radius:l};return Object(j.f)("div",{className:t},s()(Array(g)).map((function(e,t){return Object(j.f)(w,i()({},d,{key:t,color:n[f]}))})),s()(Array(u-g)).map((function(e,t){return Object(j.f)(w,i()({key:"empty-".concat(t)},d,{empty:!0}))})))}}]),n}(v.a.Component);I.displayName="ScoreBar",I.defaultProps={size:40,thickness:4,radius:3,palette:O.a.similarity.colors};var k=Object(b.a)(I,{target:"eecxaw40",label:"StyledScoreBar"})("display:flex;",(function(e){return e.vertical?"flex-direction: column-reverse;\n    justify-content: flex-end;":"min-width: 80px;"}),";"),w=Object(b.a)("div",{target:"eecxaw41",label:"Bar"})("border-radius:",(function(e){return e.radius}),"px;margin:2px;",(function(e){return e.empty&&"background-color: ".concat(e.theme.similarity.empty,";")}),";",(function(e){return e.color&&"background-color: ".concat(e.color,";")}),";width:",(function(e){return e.vertical?e.size:e.thickness}),"px;height:",(function(e){return e.vertical?e.thickness:e.size}),"px;");t.a=k},1947:function(e,t,r){"use strict";var n=r(4),i=r(1),a=r.n(i),s=Object(n.a)("div",{target:"e1uibv5p0",label:"FlowLayout"})("display:flex;flex:1;align-items:center;flex-direction:",(function(e){return e.vertical?"column":null}),";justify-content:",(function(e){return e.center?"center":null}),";overflow:",(function(e){return e.truncate?"hidden":null}),";");s.propTypes={center:a.a.bool,vertical:a.a.bool,truncate:a.a.bool},s.defaultProps={truncate:!0},t.a=s},1949:function(e,t,r){"use strict";var n=r(21),i=r.n(n).a.createActions(["fetch","showAllSimilarItems","toggleUnmerge","toggleMerge","unmerge","merge","toggleCollapseFingerprint","toggleCollapseFingerprints"]);t.a=i},2258:function(e,t,r){"use strict";var n=r(4),i=Object(n.a)("div",{target:"e1pdx9kr0",label:"Toolbar"})("background:",(function(e){return e.theme.gray100}),";border:1px solid ",(function(e){return e.theme.borderLight}),";border-bottom:none;border-radius:3px 3px 0 0;box-shadow:0 1px 0 ",(function(e){return e.theme.borderLight}),";margin:0;");t.a=i},2868:function(e,t,r){"use strict";r.r(t);var n=r(43),i=r.n(n),a=r(17),s=r.n(a),o=r(7),c=r(2),l=r.n(c),u=r(21),g=r.n(u),f=r(30),d=r.n(f),p=r(105),m=r.n(p),h=r(3),b=r(1949),y=r(1893),v=r(187),O=r(50),j=r(5),S=r.n(j),I=r(8),k=r.n(I),w=r(9),L=r.n(w),C=r(11),x=r.n(C),N=r(12),D=r.n(N),P=r(6),M=r.n(P),F=r(632),E=r(694),T=r(4),U=r(0);function R(e){var t=e.className;return Object(U.f)("div",{className:t},Object(U.f)("span",null,Object(h.b)("Similar")),Object(U.f)(q,{colorIndex:4}),Object(U.f)(q,{colorIndex:3}),Object(U.f)(q,{colorIndex:2}),Object(U.f)(q,{colorIndex:1}),Object(U.f)(q,{colorIndex:0}),Object(U.f)("span",null,Object(h.b)("Not Similar")))}R.displayName="SimilarSpectrum";var A=Object(T.a)(R,{target:"enx6bph0",label:"StyledSimilarSpectrum"})("display:flex;font-size:",(function(e){return e.theme.fontSizeSmall}),";"),q=Object(T.a)("span",{target:"enx6bph1",label:"SpectrumItem"})("border-radius:2px;margin:5px;width:14px;",(function(e){return"background-color: ".concat(e.theme.similarity.colors[e.colorIndex],";")}),";"),z=A,G=r(1891),W=r(286),B=r(205),K=r(45),J=r.n(K),V=r(108),H=r(293),Q=r(385),X=r(837),Y=r(679),Z=r(1947),$=r(340),_=r(1922),ee=r(10);function te(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var re={"exception:message:character-shingles":Object(h.b)("Exception Message"),"exception:stacktrace:application-chunks":Object(h.b)("Application Code"),"exception:stacktrace:pairs":Object(h.b)("Stacktrace Frames"),"message:message:character-shingles":Object(h.b)("Log Message")},ne=function(e){x()(n,e);var t,r=(t=n,function(){var e,r=M()(t);if(te()){var n=M()(this).constructor;e=Reflect.construct(r,arguments,n)}else e=r.apply(this,arguments);return D()(this,e)});function n(){return k()(this,n),r.apply(this,arguments)}return L()(n,[{key:"render",value:function(){var e=this.props.scoreList;return e.length?Object(U.f)("div",null,e.map((function(e){var t=i()(e,2),r=t[0],n=t[1];return Object(U.f)(ie,{key:r},Object(U.f)("div",null,re[r]),Object(U.f)(ae,{score:null===n?n:Math.round(5*n)}))}))):null}}]),n}(l.a.Component);ne.displayName="SimilarScoreCard",ne.defaultProps={scoreList:[]};var ie=Object(T.a)("div",{target:"e1am9g9r0",label:"Wrapper"})("display:flex;justify-content:space-between;margin:",Object(ee.a)(.25)," 0;"),ae=Object(T.a)("div",{target:"e1am9g9r1",label:"Score"})("height:16px;width:48px;border-radius:2px;background-color:",(function(e){return null===e.score?e.theme.similarity.empty:e.theme.similarity.colors[e.score]}),";"),se=ne,oe=["exception","message"],ce=d()({displayName:"SimilarIssueItem",mixins:[g.a.listenTo(y.a,"onGroupingUpdate")],getInitialState:function(){return{visible:!0,checked:!1,busy:!1}},onGroupingUpdate:function(e){var t=this,r=e.mergeState,n=this.props.issue;if(r){var i=r.has(n.id)&&r.get(n.id);i&&Object.keys(i).forEach((function(e){i[e]!==t.state[e]&&t.setState(s()({},e,i[e]))}))}},handleToggle:function(){var e=this.props.issue;this.state.busy||b.a.toggleMerge(e.id)},handleShowDiff:function(e){var t=this.props,r=t.orgId,n=t.groupId,i=t.issue;Object(V.f)({baseIssueId:n,targetIssueId:i.id,projectId:i.project.slug,orgId:r}),e.stopPropagation()},handleCheckClick:function(){},render:function(){var e=this.props,t=e.aggregate,r=e.scoresByInterface,n=e.issue;if(!this.state.visible)return null;var i=J()("group","similar-issue",{isResolved:"resolved"===n.status,busy:this.state.busy});return Object(U.f)(G.a,{"data-test-id":"similar-item-row",className:i,responsive:!0,onClick:this.handleToggle},Object(U.f)(Z.a,{truncate:!0},Object(U.f)(Z.a,{truncate:!0},Object(U.f)("div",{className:"action-column"},Object(U.f)(H.a,{id:n.id,value:n.id,checked:this.state.checked,onChange:this.handleCheckClick})),Object(U.f)("div",{className:"event-details",style:{flex:1}},Object(U.f)(Y.a,{data:n}),Object(U.f)(X.a,S()({},n,{lastSeen:null,showAssignee:!0})))),Object(U.f)("button",{style:{marginRight:2},className:"btn btn-default btn-xs",onClick:this.handleShowDiff},"Diff")),Object(U.f)("div",{className:"similar-score-columns"},Object(U.f)(Q.a,{className:"similar-score-column",value:n.count}),oe.map((function(e){var n=t[e],i=r[e]||[],a="number"!=typeof n||Number.isNaN(n)?0:n;return Object(U.f)("div",{key:e,className:"similar-score-column"},Object(U.f)($.b,{body:i.length&&Object(U.f)(se,{scoreList:i})},Object(U.f)(_.a,{vertical:!0,score:Math.round(5*a)})))}))))}}),le=r(1684),ue=r(2258),ge=r(486),fe=d()({displayName:"SimilarToolbar",mixins:[g.a.listenTo(y.a,"onGroupingUpdate")],getInitialState:function(){return{mergeCount:0}},onGroupingUpdate:function(e){var t=e.mergeList;t&&t.size!==this.state.mergedCount&&this.setState({mergeCount:t.size})},render:function(){var e=this.props.onMerge;return Object(U.f)(ue.a,{className:"similar-toolbar"},Object(U.f)(G.a,{responsive:!0},Object(U.f)(Z.a,{style:{flex:1}},Object(U.f)(Z.a,null,Object(U.f)("div",{className:"similar-toolbar-actions"},Object(U.f)(le.a,{"data-test-id":"merge",disabled:0===this.state.mergeCount,title:Object(h.b)("Merging ".concat(this.state.mergeCount," issues")),message:Object(h.b)("Are you sure you want to merge these issues?"),className:"btn btn-sm btn-default",onConfirm:e},Object(h.b)("Merge")," (",this.state.mergeCount||0,")")))),Object(U.f)("div",{className:"similar-score-columns"},Object(U.f)(ge.a,{className:"similar-score-column event-count-header"},Object(h.b)("Events")),Object(U.f)(ge.a,{className:"similar-score-column event-similar-header"},Object(h.b)("Exception")),Object(U.f)(ge.a,{className:"similar-score-column event-similar-header"},Object(h.b)("Message")))))}});function de(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var pe=function(e){x()(n,e);var t,r=(t=n,function(){var e,r=M()(t);if(de()){var n=M()(this).constructor;e=Reflect.construct(r,arguments,n)}else e=r.apply(this,arguments);return D()(this,e)});function n(){var e;k()(this,n);for(var t=arguments.length,i=new Array(t),a=0;a<t;a++)i[a]=arguments[a];return(e=r.call.apply(r,[this].concat(i))).renderEmpty=function(){return Object(U.f)(B.a,null,Object(U.f)(W.a,null,Object(U.f)("p",null,Object(h.b)("There are no similar issues."))))},e.handleShowAll=function(){e.setState({showAllItems:!0})},e.state={showAllItems:!1},e}return L()(n,[{key:"render",value:function(){var e=this.props,t=e.orgId,r=e.groupId,n=e.items,i=e.filteredItems,a=e.pageLinks,s=e.onMerge,o=!!i.length,c=n.length>0||o,l=n.concat(this.state.showAllItems&&i||[]);return c?Object(U.f)("div",{className:"similar-list-container"},Object(U.f)(G.a,{className:"similar-list-header"},Object(U.f)("h2",null,Object(U.f)("span",null,Object(h.b)("Similar Issues")),Object(U.f)(E.a,{count:n.length+i.length})),Object(U.f)(z,null)),Object(U.f)(fe,{onMerge:s}),Object(U.f)("div",{className:"similar-list"},l.map((function(e){return Object(U.f)(ce,S()({key:e.issue.id,orgId:t,groupId:r},e))})),o&&!this.state.showAllItems&&Object(U.f)("div",{className:"similar-items-footer"},Object(U.f)("button",{className:"btn btn-default btn-xl",onClick:this.handleShowAll},"Show ",i.length," issues below threshold"))),Object(U.f)(F.a,{pageLinks:a})):this.renderEmpty()}}]),n}(l.a.Component);pe.displayName="SimilarList",pe.defaultProps={filteredItems:[]};var me=pe;function he(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function be(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?he(Object(r),!0).forEach((function(t){s()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):he(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var ye=d()({displayName:"GroupGroupingView",mixins:[g.a.listenTo(y.a,"onGroupingUpdate")],getInitialState:function(){return{similarItems:[],filteredSimilarItems:[],similarLinks:[],loading:!0,error:!1}},componentWillMount:function(){this.fetchData()},componentWillReceiveProps:function(e){e.params.groupId===this.props.params.groupId&&e.location.search===this.props.location.search||this.fetchData()},onGroupingUpdate:function(e){var t=e.mergedParent,r=e.similarItems,n=e.similarLinks,i=e.filteredSimilarItems,a=e.loading,s=e.error;if(r)this.setState({similarItems:r,similarLinks:n,filteredSimilarItems:i,loading:void 0!==a&&a,error:void 0!==s&&s});else if(t&&t!==this.props.params.groupId){var c=this.props.params;o.browserHistory.push("/organizations/".concat(c.orgId,"/issues/").concat(t,"/similar/"))}},getEndpoint:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"similar",t=this.props.params,r=be({},this.props.location.query,{limit:50});return"/issues/".concat(t.groupId,"/").concat(e,"/?").concat(m.a.stringify(r))},hasSimilarityFeature:function(){return new Set(this.props.project.features).has("similarity-view")},fetchData:function(){this.setState({loading:!0,error:!1});var e=[];this.hasSimilarityFeature()&&e.push({endpoint:this.getEndpoint("similar"),dataKey:"similar",queryParams:this.props.location.query}),b.a.fetch(e)},handleMerge:function(){var e=this.props,t=e.query,r=e.params;if(r){var n=this.state.similarItems.length?this.state.similarItems:this.state.filteredSimilarItems,a=i()(n,1)[0];b.a.merge({params:r,query:t,projectId:a.issue.project.slug})}},render:function(){var e=this.props.params,t=e.orgId,r=e.groupId,n=this.state.loading,i=this.state.error&&!n,a=!i&&!n,s=this.hasSimilarityFeature()&&(this.state.similarItems.length>=0||this.state.filteredSimilarItems.length>=0)&&a;return Object(U.f)("div",null,Object(U.f)("div",{className:"alert alert-block alert-warning"},Object(U.f)("strong",null,Object(h.b)("Warning"),":")," ",Object(h.b)("This is an experimental feature. Data may not be immediately available while we process merges.")),n&&Object(U.f)(O.default,null),i&&Object(U.f)(v.a,{message:"Unable to load similar issues, please try again later",onRetry:this.fetchData}),s&&Object(U.f)(me,{items:this.state.similarItems,filteredItems:this.state.filteredSimilarItems,onMerge:this.handleMerge,orgId:t,groupId:r,pageLinks:this.state.similarLinks}))}});t.default=ye},2880:function(e,t,r){"use strict";r.r(t),r.d(t,"GroupMergedView",(function(){return fe}));var n=r(17),i=r.n(n),a=r(2),s=r.n(a),o=r(21),c=r.n(o),l=r(30),u=r.n(l),g=r(105),f=r.n(g),d=r(3),p=r(1949),m=r(1893),h=r(187),b=r(50),y=r(8),v=r.n(y),O=r(9),j=r.n(O),S=r(11),I=r.n(S),k=r(12),w=r.n(k),L=r(6),C=r.n(L),x=r(4),N=r(205),D=r(286),P=r(632),M=r(694),F=r(293),E=r(679),T=r(1947),U=r(10),R=r(0),A=u()({displayName:"MergedItem",mixins:[c.a.listenTo(m.a,"onGroupingChange")],getInitialState:function(){return{collapsed:!1,checked:!1,busy:!1}},onGroupingChange:function(e){var t=this,r=e.unmergeState;if(r){var n=this.props.fingerprint,a=r.has(n)&&r.get(n);a&&Object.keys(a).forEach((function(e){a[e]!==t.state[e]&&t.setState(i()({},e,a[e]))}))}},handleToggleEvents:function(){var e=this.props.fingerprint;p.a.toggleCollapseFingerprint(e)},handleLabelClick:function(e){e.preventDefault()},handleToggle:function(){var e=this.props,t=e.disabled,r=e.fingerprint,n=e.event;t||this.state.busy||p.a.toggleUnmerge([r,n.id])},handleCheckClick:function(){},render:function(){var e=this.props,t=e.disabled,r=e.event,n=e.fingerprint,i=t||this.state.disabled;return Object(R.f)(q,{busy:this.state.busy},Object(R.f)(G,{expanded:!this.state.collapsed},Object(R.f)(T.a,{onClick:this.handleToggle},Object(R.f)(z,null,Object(R.f)(F.a,{id:n,value:n,checked:this.state.checked,disabled:i,onChange:this.handleCheckClick})),Object(R.f)(W,{onClick:this.handleLabelClick,htmlFor:n},n)),Object(R.f)("div",null,Object(R.f)("span",null),Object(R.f)(B,{onClick:this.handleToggleEvents},this.state.collapsed?Object(R.f)("i",{className:"icon-arrow-down"}):Object(R.f)("i",{className:"icon-arrow-up"})))),!this.state.collapsed&&Object(R.f)(K,{className:"event-list"},r&&Object(R.f)(J,{className:"event-details"},Object(R.f)(T.a,null,Object(R.f)(E.a,{data:r,hideIcons:!0,hideLevel:!0})))))}}),q=Object(x.a)("div",{target:"e9r3vga0",label:"MergedGroup"})((function(e){return e.busy&&"opacity: 0.2"}),";"),z=Object(x.a)("div",{target:"e9r3vga1",label:"ActionColumn"})({name:"1rergdr",styles:"display:flex;padding:0 10px;align-items:center;input{margin:0;}"}),G=Object(x.a)("div",{target:"e9r3vga2",label:"Controls"})("display:flex;justify-content:space-between;border-top:1px solid ",(function(e){return e.theme.borderLight}),";background-color:#f3f1f6;padding:",Object(U.a)(.5)," 0;",(function(e){return e.expanded&&"border-bottom: 1px solid ".concat(e.theme.borderLight)}),";",q,"{&:first-child &{border-top:none;}&:last-child &{border-top:none;border-bottom:1px solid ",(function(e){return e.theme.borderLight}),";}}"),W=Object(x.a)("label",{target:"e9r3vga3",label:"Fingerprint"})("font-family:",(function(e){return e.theme.text.familyMono}),";",G," &{font-weight:normal;margin:0;}"),B=Object(x.a)("span",{target:"e9r3vga4",label:"Collapse"})({name:"1myftmo",styles:"cursor:pointer;padding:0 10px;"}),K=Object(x.a)("div",{target:"e9r3vga5",label:"MergedEventList"})({name:"1qzh383",styles:"overflow:hidden;border:none;"}),J=Object(x.a)("div",{target:"e9r3vga6",label:"EventDetails"})({name:"fk2u57",styles:"display:flex;justify-content:space-between;.event-list &{padding:10px;}"}),V=A,H=r(43),Q=r.n(H),X=r(337),Y=r.n(X),Z=r(108),$=r(32),_=r(1684),ee=r(1891),te=r(2258),re=u()({displayName:"MergedToolbar",mixins:[c.a.listenTo(m.a,"onGroupingUpdate")],getInitialState:function(){var e=m.a.unmergeList,t=m.a.unmergeLastCollapsed,r=m.a.unmergeDisabled;return{enableFingerprintCompare:m.a.enableFingerprintCompare,unmergeList:e,unmergeLastCollapsed:t,unmergeDisabled:r}},onGroupingUpdate:function(e){this.setState(Y()(e,["unmergeLastCollapsed","unmergeDisabled","unmergeList","enableFingerprintCompare"]))},handleShowDiff:function(e){var t=this.props,r=t.groupId,n=t.projectId,i=t.orgId,a=this.state.unmergeList.entries();if(2===this.state.unmergeList.size){var s=Array.from(a).map((function(e){return Q()(e,2)[1]})),o=Q()(s,2),c=o[0],l=o[1];Object(Z.f)({baseIssueId:r,targetIssueId:r,baseEventId:c,targetEventId:l,orgId:i,projectId:n}),e.stopPropagation()}},render:function(){var e=this.props,t=e.onUnmerge,r=e.onToggleCollapse,n=this.state.unmergeList&&this.state.unmergeList.size||0;return Object(R.f)(ie,null,Object(R.f)(ee.a,null,Object(R.f)(ee.a,null,Object(R.f)("div",null,Object(R.f)(_.a,{disabled:this.state.unmergeDisabled,title:Object(d.b)("Unmerging ".concat(n," events")),message:Object(d.b)("These events will be unmerged and grouped into a new issue. Are you sure you want to unmerge these events?"),className:"btn btn-sm btn-default",onConfirm:t},Object(d.b)("Unmerge")," (",n||0,")"),Object(R.f)(ne,{size:"small",disabled:!this.state.enableFingerprintCompare,onClick:this.handleShowDiff},Object(d.b)("Compare")))),Object(R.f)(ee.a,null,Object(R.f)("div",null,Object(R.f)($.a,{size:"small",onClick:r},this.state.unmergeLastCollapsed?Object(d.b)("Expand All"):Object(d.b)("Collapse All"))))))}}),ne=Object(x.a)($.a,{target:"e1seayw30",label:"CompareButton"})("margin-left:",Object(U.a)(1),";"),ie=Object(x.a)(te.a,{target:"e1seayw31",label:"StyledToolbar"})("padding:",Object(U.a)(.5)," ",Object(U.a)(1),";"),ae=re;function se(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var oe=function(e){I()(n,e);var t,r=(t=n,function(){var e,r=C()(t);if(se()){var n=C()(this).constructor;e=Reflect.construct(r,arguments,n)}else e=r.apply(this,arguments);return w()(this,e)});function n(){var e;v()(this,n);for(var t=arguments.length,i=new Array(t),a=0;a<t;a++)i[a]=arguments[a];return(e=r.call.apply(r,[this].concat(i))).renderEmpty=function(){return Object(R.f)(D.a,null,Object(R.f)("p",null,Object(d.b)("There don't seem to be any hashes for this issue.")))},e}return j()(n,[{key:"render",value:function(){var e=this.props,t=e.items,r=e.pageLinks,n=e.onToggleCollapse,i=e.onUnmerge,a=e.orgId,s=e.projectId,o=t.filter((function(e){return!!e.latestEvent}));return o.length>0?Object(R.f)("div",null,Object(R.f)("h2",null,Object(R.f)("span",null,Object(d.b)("Merged fingerprints with latest event")),Object(R.f)(M.a,{count:o.length})),Object(R.f)(ae,{onToggleCollapse:n,onUnmerge:i,orgId:a,projectId:s}),Object(R.f)(le,null,o.map((function(e){var r=e.id,n=e.latestEvent;return Object(R.f)(V,{key:r,orgId:a,disabled:1===t.length,event:n,fingerprint:r})}))),Object(R.f)(P.a,{pageLinks:r})):Object(R.f)(N.a,null,this.renderEmpty())}}]),n}(s.a.Component);oe.displayName="MergedList";var ce=oe,le=Object(x.a)("div",{target:"e16p6prb0",label:"MergedItems"})("border:1px solid ",(function(e){return e.theme.borderLight}),";border-top:none;");function ue(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ge(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ue(Object(r),!0).forEach((function(t){i()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ue(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var fe=u()({displayName:"GroupMergedView",mixins:[c.a.listenTo(m.a,"onGroupingUpdate")],getInitialState:function(){return{mergedItems:[],loading:!0,error:!1,query:this.props.location.query.query||""}},componentWillMount:function(){this.fetchData()},componentWillReceiveProps:function(e){if(e.params.groupId!==this.props.params.groupId||e.location.search!==this.props.location.search){var t=e.location.query;this.setState({query:t.query},this.fetchData)}},onGroupingUpdate:function(e){var t=e.mergedItems,r=e.mergedLinks,n=e.loading,i=e.error;t&&this.setState({mergedItems:t,mergedLinks:r,loading:void 0!==n&&n,error:void 0!==i&&i})},getEndpoint:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"hashes",t=this.props.params,r=ge({},this.props.location.query,{limit:50,query:this.state.query});return"/issues/".concat(t.groupId,"/").concat(e,"/?").concat(f.a.stringify(r))},fetchData:function(){p.a.fetch([{endpoint:this.getEndpoint("hashes"),dataKey:"merged",queryParams:this.props.location.query}])},handleCollapse:function(){p.a.collapseFingerprints()},handleUnmerge:function(){p.a.unmerge({groupId:this.props.params.groupId,loadingMessage:"".concat(Object(d.b)("Unmerging events"),"..."),successMessage:Object(d.b)("Events successfully queued for unmerging."),errorMessage:Object(d.b)("Unable to queue events for unmerging.")})},render:function(){var e=this.state.loading,t=this.state.error&&!e,r=!t&&!e;return Object(R.f)("div",null,Object(R.f)("div",{className:"alert alert-block alert-warning"},Object(R.f)("strong",null,Object(d.b)("Warning"),":")," ",Object(d.b)("This is an experimental feature. Data may not be immediately available while we process unmerges.")),e&&Object(R.f)(b.default,null),t&&Object(R.f)(h.a,{message:"Unable to load merged events, please try again later",onRetry:this.fetchData}),r&&Object(R.f)(ce,{orgId:this.props.params.orgId,projectId:this.props.project.slug,items:this.state.mergedItems,pageLinks:this.state.mergedLinks,onUnmerge:this.handleUnmerge,onToggleCollapse:p.a.toggleCollapseFingerprints}))}});t.default=fe}}]);
//# sourceMappingURL=GroupSimilarView.js.map