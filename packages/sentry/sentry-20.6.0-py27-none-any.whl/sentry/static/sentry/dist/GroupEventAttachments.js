(window.sntryWpJsonp=window.sntryWpJsonp||[]).push([[84],{1649:function(t,e,n){"use strict";var r=n(15),a=n.n(r),c=n(8),o=n.n(c),i=n(9),u=n.n(i),l=n(11),s=n.n(l),f=n(12),p=n.n(f),d=n(6),b=n.n(d),h=n(2),y=n.n(h),v=n(118),O=n.n(v),m=n(36),j=n(0);function g(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var D=function(t){s()(r,t);var e,n=(e=r,function(){var t,n=b()(e);if(g()){var r=b()(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return p()(this,t)});function r(){var t;o()(this,r);for(var e=arguments.length,a=new Array(e),c=0;c<e;c++)a[c]=arguments[c];return(t=n.call.apply(n,[this].concat(a))).getFormat=function(e){var n=e.clock24Hours,r=t.props,a=r.dateOnly,c=r.timeOnly,o=r.seconds,i=r.shortDate;return a?"LL":c?"LT":i?"MM/DD/YYYY":n?"MMMM D YYYY HH:mm:ss z":o?"ll LTS z":"lll"},t}return u()(r,[{key:"render",value:function(){var t,e=this.props,n=e.date,r=e.utc,c=(e.seconds,e.shortDate,e.dateOnly,e.timeOnly,a()(e,["date","utc","seconds","shortDate","dateOnly","timeOnly"])),o=m.default.get("user"),i=null==o?void 0:o.options,u=this.getFormat(i);return Object(j.f)("time",c,r?O.a.utc(n).format(u):O.a.tz(n,null!==(t=null==i?void 0:i.timezone)&&void 0!==t?t:"").format(u))}}]),r}(y.a.Component);D.displayName="DateTime",D.defaultProps={seconds:!0},e.a=D},1685:function(t,e,n){"use strict";n(2);var r=n(25),a=n(336),c=n(0);function o(t){var e=t.className,n=t.bytes;return Object(c.f)("span",{className:e},Object(a.a)({value:Object(r.i)(n),fixed:"xx KB"}))}o.displayName="FileSize",e.a=o},1818:function(t,e,n){"use strict";var r=n(8),a=n.n(r),c=n(9),o=n.n(c),i=n(11),u=n.n(i),l=n(12),s=n.n(l),f=n(6),p=n.n(f),d=n(2),b=n.n(d),h=n(36),y=n(81);function v(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var O=function(t){u()(r,t);var e,n=(e=r,function(){var t,n=p()(e);if(v()){var r=p()(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return s()(this,t)});function r(){return a()(this,r),n.apply(this,arguments)}return o()(r,[{key:"hasAttachmentsRole",value:function(){var t=h.default.get("user");if(!t)return!1;if(t.isSuperuser)return!0;var e=this.props.organization,n=e.availableRoles,r=e.attachmentsRole,a=e.role;if(!Array.isArray(n))return!1;var c=n.map((function(t){return t.id})),o=c.indexOf(r);return c.indexOf(a||"")>=o}},{key:"getDownloadUrl",value:function(){var t=this.props,e=t.attachment,n=t.organization,r=t.eventId,a=t.projectId;return"/api/0/projects/".concat(n.slug,"/").concat(a,"/events/").concat(r,"/attachments/").concat(e.id,"/")}},{key:"render",value:function(){return(0,this.props.children)(this.hasAttachmentsRole()?this.getDownloadUrl():null)}}]),r}(b.a.PureComponent);O.displayName="AttachmentUrl",e.a=Object(y.a)(O)},1857:function(t,e,n){"use strict";var r=n(20),a=n.n(r),c=n(28),o=n.n(c),i=n(8),u=n.n(i),l=n(9),s=n.n(l),f=n(11),p=n.n(f),d=n(12),b=n.n(d),h=n(6),y=n.n(h),v=n(4),O=n(2),m=n.n(O),j=n(3),g=n(32),D=n(10),w=n(284),R=n(27),A=n(58),I=n(0);function x(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var P=function(t){p()(r,t);var e,n=(e=r,function(){var t,n=y()(e);if(x()){var r=y()(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return b()(this,t)});function r(){var t;u()(this,r);for(var e=arguments.length,c=new Array(e),i=0;i<e;i++)c[i]=arguments[i];return(t=n.call.apply(n,[this].concat(c))).handleDelete=o()(a.a.mark((function e(){var n,r,c,o,i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.props,r=n.api,c=n.url,o=n.onDelete,i=n.attachmentId,!c){e.next=10;break}return e.prev=2,e.next=5,r.requestPromise(c,{method:"DELETE"});case 5:o(i),e.next=10;break;case 8:e.prev=8,e.t0=e.catch(2);case 10:case"end":return e.stop()}}),e,null,[[2,8]])}))),t}return s()(r,[{key:"render",value:function(){var t=this.props.url;return Object(I.f)(m.a.Fragment,null,Object(I.f)(k,{size:"xsmall",icon:"icon-download",href:t?"".concat(t,"?download=1"):"",disabled:!t,title:t?void 0:Object(j.b)("Insufficient permissions to download attachments")},Object(j.b)("Download")),Object(I.f)(w.a,{confirmText:Object(j.b)("Delete"),message:Object(j.b)("Are you sure you wish to delete this file?"),priority:"danger",onConfirm:this.handleDelete,disabled:!t},Object(I.f)(g.a,{size:"xsmall",icon:Object(I.f)(R.q,{size:"xs"}),disabled:!t,priority:"danger",title:t?void 0:Object(j.b)("Insufficient permissions to delete attachments")})))}}]),r}(m.a.Component);P.displayName="EventAttachmentActions";var k=Object(v.a)(g.a,{target:"ewomrm90",label:"DownloadButton"})("margin-right:",Object(D.a)(.5),";");e.a=Object(A.a)(P)},1932:function(t,e,n){var r=n(291),a=n(174);t.exports=function(t){return a(t)&&r(t)}},2653:function(t,e,n){var r=n(893),a=n(662),c=n(2654),o=n(1932),i=a((function(t){return c(r(t,o))}));t.exports=i},2654:function(t,e,n){var r=n(2655),a=n(504),c=n(661);t.exports=function(t,e,n){var o=t.length;if(o<2)return o?c(t[0]):[];for(var i=-1,u=Array(o);++i<o;)for(var l=t[i],s=-1;++s<o;)s!=i&&(u[i]=r(u[i]||l,t[s],e,n));return c(a(u,1),e,n)}},2655:function(t,e,n){var r=n(673),a=n(891),c=n(896),o=n(343),i=n(347),u=n(674);t.exports=function(t,e,n,l){var s=-1,f=a,p=!0,d=t.length,b=[],h=e.length;if(!d)return b;n&&(e=o(e,i(n))),l?(f=c,p=!1):e.length>=200&&(f=u,p=!1,e=new r(e));t:for(;++s<d;){var y=t[s],v=null==n?y:n(y);if(y=l||0!==y?y:0,p&&v==v){for(var O=h;O--;)if(e[O]===v)continue t;b.push(y)}else f(e,v,l)||b.push(y)}return b}},2867:function(t,e,n){"use strict";n.r(e);var r=n(2),a=n.n(r),c=n(188),o=n(81),i=n(648),u=n(17),l=n.n(u),s=n(29),f=n.n(s),p=n(8),d=n.n(p),b=n(9),h=n.n(b),y=n(143),v=n.n(y),O=n(11),m=n.n(O),j=n(12),g=n.n(j),D=n(6),w=n.n(D),R=n(337),A=n.n(R),I=n(7),x=n(205),P=n(3),k=n(286),S=n(50),z=n(632),E=n(1640),N=n(4),q=n(104),C=n(1649),T=n(1685),L=n(1818),Y=n(1857),F={"event.minidump":Object(P.b)("Minidump"),"event.applecrashreport":Object(P.b)("Apple Crash Report"),"event.attachment":Object(P.b)("Other")},M=n(0),B=function(t){var e=t.attachment,n=t.projectId,r=t.onDelete,a=t.isDeleted,c=t.orgId,o=t.groupId;return Object(M.f)(G,{isDeleted:a},Object(M.f)("td",null,Object(M.f)("h5",null,e.name,Object(M.f)("br",null),Object(M.f)("small",null,Object(M.f)(C.a,{date:e.dateCreated})," Â·"," ",Object(M.f)(q.a,{to:"/organizations/".concat(c,"/issues/").concat(o,"/events/").concat(e.event_id,"/")},e.event_id)))),Object(M.f)("td",null,F[e.type]||Object(P.b)("Other")),Object(M.f)("td",null,Object(M.f)(T.a,{bytes:e.size})),Object(M.f)("td",null,Object(M.f)(L.a,{projectId:n,eventId:e.event_id,attachment:e},(function(t){return!a&&Object(M.f)(Y.a,{url:t,onDelete:r,attachmentId:e.id})}))))};B.displayName="GroupEventAttachmentsTableRow";var G=Object(N.a)("tr",{target:"ekv38qo0",label:"TableRow"})("opacity:",(function(t){return t.isDeleted?.3:1}),";td{text-decoration:",(function(t){return t.isDeleted?"line-through":"normal"}),";}"),H=B,U=function(t){var e=t.attachments,n=t.orgId,r=t.projectId,a=t.groupId,c=t.onDelete,o=t.deletedAttachments,i=[Object(P.b)("Name"),Object(P.b)("Type"),Object(P.b)("Size"),Object(P.b)("Actions")];return Object(M.f)("table",{className:"table events-table"},Object(M.f)("thead",null,Object(M.f)("tr",null,i.map((function(t){return Object(M.f)("th",{key:t},t)})))),Object(M.f)("tbody",null,e.map((function(t){return Object(M.f)(H,{key:t.id,attachment:t,orgId:n,projectId:r,groupId:a,onDelete:c,isDeleted:o.some((function(e){return t.id===e}))})}))))};U.displayName="GroupEventAttachmentsTable";var W=U,_=n(186),J=n.n(_),Q=n(2653),K=n.n(Q),V=n(10),X=n(190),Z=n(32);function $(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}var tt=function(t){var e=t.location,n=e.query,r=e.pathname,a=n.types,c=["event.minidump","event.applecrashreport"],o=J()(n,"types"),i=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?$(Object(n),!0).forEach((function(e){l()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):$(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},n,{types:c}),u="";return void 0===a?u="all":0===K()(c,a).length&&(u="onlyCrash"),Object(M.f)(et,null,Object(M.f)(X.a,{merged:!0,active:u},Object(M.f)(Z.a,{barId:"all",size:"small",to:{pathname:r,query:o}},Object(P.b)("All Attachments")),Object(M.f)(Z.a,{barId:"onlyCrash",size:"small",to:{pathname:r,query:i}},Object(P.b)("Only Crash Reports"))))};tt.displayName="GroupEventAttachmentsFilter";var et=Object(N.a)("div",{target:"eoyp7bi0",label:"FilterWrapper"})("display:flex;justify-content:flex-end;margin-bottom:",Object(V.a)(3),";"),nt=Object(I.withRouter)(tt);function rt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function at(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?rt(Object(n),!0).forEach((function(e){l()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):rt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function ct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var ot=function(t){m()(r,t);var e,n=(e=r,function(){var t,n=w()(e);if(ct()){var r=w()(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return g()(this,t)});function r(){var t;d()(this,r);for(var e=arguments.length,a=new Array(e),c=0;c<e;c++)a[c]=arguments[c];return(t=n.call.apply(n,[this].concat(a))).handleDelete=function(e){t.setState((function(t){return{deletedAttachments:[].concat(f()(t.deletedAttachments),[e])}}))},t}return h()(r,[{key:"getDefaultState",value:function(){return at({},v()(w()(r.prototype),"getDefaultState",this).call(this),{deletedAttachments:[]})}},{key:"getEndpoints",value:function(){var t=this.props,e=t.params,n=t.location;return[["eventAttachments","/issues/".concat(e.groupId,"/attachments/"),{query:at({},A()(n.query,["cursor","environment","types"]),{limit:50})}]]}},{key:"renderNoQueryResults",value:function(){return Object(M.f)(k.a,null,Object(M.f)("p",null,Object(P.b)("Sorry, no event attachments match your search query.")))}},{key:"renderEmpty",value:function(){return Object(M.f)(k.a,null,Object(M.f)("p",null,Object(P.b)("There don't seem to be any event attachments yet.")))}},{key:"renderLoading",value:function(){return this.renderBody()}},{key:"renderInnerBody",value:function(){var t=this.props,e=t.projectSlug,n=t.params,r=t.location,a=this.state,c=a.loading,o=a.eventAttachments,i=a.deletedAttachments;return c?Object(M.f)(S.default,null):o.length>0?Object(M.f)(W,{attachments:o,orgId:n.orgId,projectId:e,groupId:n.groupId,onDelete:this.handleDelete,deletedAttachments:i}):r.query.types?this.renderNoQueryResults():this.renderEmpty()}},{key:"renderBody",value:function(){return Object(M.f)(a.a.Fragment,null,Object(M.f)(nt,null),Object(M.f)(x.a,{className:"event-list"},Object(M.f)(x.c,null,this.renderInnerBody())),Object(M.f)(z.a,{pageLinks:this.state.eventAttachmentsPageLinks}))}}]),r}(E.a),it=I.withRouter(ot),ut=function(t){var e=t.organization,n=t.group;return Object(M.f)(c.a,{features:["event-attachments"],organization:e,renderDisabled:function(t){return Object(M.f)(i.a,t)}},Object(M.f)(it,{projectSlug:n.project.slug}))};ut.displayName="GroupEventAttachmentsContainer";e.default=Object(o.a)(ut)}}]);
//# sourceMappingURL=GroupEventAttachments.js.map