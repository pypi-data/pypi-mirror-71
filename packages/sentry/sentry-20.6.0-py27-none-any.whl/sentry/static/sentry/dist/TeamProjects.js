(window.sntryWpJsonp=window.sntryWpJsonp||[]).push([[199],{2124:function(t,e,n){"use strict";var r=n(8),c=n.n(r),a=n(9),o=n.n(a),s=n(11),i=n.n(s),l=n(12),u=n.n(l),f=n(6),p=n.n(f),d=n(4),j=n(2),h=n.n(j),b=n(675),m=n(104),g=n(5),v=n.n(g),O=n(15),y=n.n(O),k=n(0);function P(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var R=function(t){i()(r,t);var e,n=(e=r,function(){var t,n=p()(e);if(P()){var r=p()(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return u()(this,t)});function r(){return c()(this,r),n.apply(this,arguments)}return o()(r,[{key:"render",value:function(){var t=this.props,e=t.project,n=y()(t,["project"]);return Object(k.f)("span",v()({className:"project-label"},n),Object(k.f)("span",{className:"project-name"},e.slug))}}]),r}(h.a.PureComponent);R.displayName="ProjectLabel";var S=n(10);function z(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var I=function(t){i()(r,t);var e,n=(e=r,function(){var t,n=p()(e);if(z()){var r=p()(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return u()(this,t)});function r(t){var e;return c()(this,r),(e=n.call(this,t)).handleToggleBookmark=function(t){e.setState({isBookmarked:t})},e.state={isBookmarked:e.props.project.isBookmarked},e}return o()(r,[{key:"render",value:function(){var t=this.props,e=t.project,n=t.organization;return Object(k.f)(q,{key:e.id},Object(k.f)(L,{organization:n,project:e,isBookmarked:this.state.isBookmarked,onToggle:this.handleToggleBookmark}),Object(k.f)(m.a,{to:"/settings/".concat(n.slug,"/projects/").concat(e.slug,"/")},Object(k.f)(R,{project:e})))}}]),r}(h.a.Component);I.displayName="ProjectItem";var q=Object(d.a)("div",{target:"enngb6z0",label:"Container"})({name:"70qvj9",styles:"display:flex;align-items:center;"}),L=Object(d.a)(b.a,{target:"enngb6z1",label:"BookmarkLink"})("margin-right:",Object(S.a)(1),";margin-top:-",Object(S.a)(.25),";");e.a=I},2797:function(t,e,n){"use strict";n.r(e),n.d(e,"TeamProjects",(function(){return W}));var r=n(5),c=n.n(r),a=n(43),o=n.n(a),s=n(8),i=n.n(s),l=n(9),u=n.n(l),f=n(11),p=n.n(f),d=n(12),j=n.n(d),h=n(6),b=n.n(h),m=n(4),g=n(2),v=n.n(g),O=n(205),y=n(31),k=n(25),P=n(3),R=n(32),S=n(289),z=n(386),I=n(631),q=n(46),L=n(187),T=n(50),w=n(632),A=n(42),x=n(2124),B=n(38),D=n(10),C=n(58),N=n(81),U=n(0);function E(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var W=function(t){p()(r,t);var e,n=(e=r,function(){var t,n=b()(e);if(E()){var r=b()(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return j()(this,t)});function r(){var t;i()(this,r);for(var e=arguments.length,c=new Array(e),a=0;a<e;a++)c[a]=arguments[a];return(t=n.call.apply(n,[this].concat(c))).state={error:!1,loading:!0,pageLinks:null,unlinkedProjects:[],linkedProjects:[]},t.fetchAll=function(){t.fetchTeamProjects(),t.fetchUnlinkedProjects()},t.fetchTeamProjects=function(){var e=t.props,n=e.location,r=e.params,c=r.orgId,a=r.teamId;t.setState({loading:!0}),t.props.api.requestPromise("/organizations/".concat(c,"/projects/"),{query:{query:"team:".concat(a),cursor:n.query.cursor||""},includeAllArgs:!0}).then((function(e){var n=o()(e,3),r=n[0],c=(n[1],n[2]);t.setState({loading:!1,error:!1,linkedProjects:r,pageLinks:c.getResponseHeader("Link")})})).catch((function(){t.setState({loading:!1,error:!0})}))},t.fetchUnlinkedProjects=function(e){var n=t.props.params,r=n.orgId,c=n.teamId;t.props.api.requestPromise("/organizations/".concat(r,"/projects/"),{query:{query:e?"!team:".concat(c," ").concat(e):"!team:".concat(c)}}).then((function(e){t.setState({unlinkedProjects:e})}))},t.handleLinkProject=function(e,n){var r=t.props.params,c=r.orgId,a=r.teamId;t.props.api.request("/projects/".concat(c,"/").concat(e.slug,"/teams/").concat(a,"/"),{method:"add"===n?"POST":"DELETE",success:function(e){t.fetchAll(),A.a.updateSuccess(e),Object(y.d)("add"===n?Object(P.b)("Successfully added project to team."):Object(P.b)("Successfully removed project from team"))},error:function(){Object(y.a)(Object(P.b)("Wasn't able to change project association."))}})},t.handleProjectSelected=function(e){var n=t.state.unlinkedProjects.find((function(t){return t.id===e.value}));t.handleLinkProject(n,"add")},t.handleQueryUpdate=function(e){t.fetchUnlinkedProjects(e.target.value)},t}return u()(r,[{key:"componentDidMount",value:function(){this.fetchAll()}},{key:"componentDidUpdate",value:function(t){t.params.orgId===this.props.params.orgId&&t.params.teamId===this.props.params.teamId||this.fetchAll(),t.location!==this.props.location&&this.fetchTeamProjects()}},{key:"projectPanelContents",value:function(t){var e=this,n=this.props.organization,r=new Set(n.access).has("org:write");return t.length?Object(k.u)(t).map((function(t){return Object(U.f)(M,{key:t.id},Object(U.f)(x.a,{project:t,organization:n}),Object(U.f)(B.a,{disabled:r,title:Object(P.b)("You do not have enough permission to change project association.")},Object(U.f)(R.a,{size:"small",disabled:!r,onClick:function(){e.handleLinkProject(t,"remove")}},Object(U.f)(J,null)," ",Object(P.b)("Remove"))))})):Object(U.f)(I.a,{size:"large",icon:"icon-circle-exclamation"},Object(P.b)("This team doesn't have access to any projects."))}},{key:"render",value:function(){var t=this,e=this.state,n=e.linkedProjects,r=e.unlinkedProjects,a=e.error,o=e.loading;if(a)return Object(U.f)(L.a,{onRetry:function(){return t.fetchAll()}});if(o)return Object(U.f)(T.default,null);var s=new Set(this.props.organization.access),i=r.map((function(t){return{value:t.id,searchKey:t.slug,label:Object(U.f)(Q,null,t.slug)}}));return Object(U.f)(v.a.Fragment,null,Object(U.f)(O.a,null,Object(U.f)(O.e,{hasButtons:!0},Object(U.f)("div",null,Object(P.b)("Projects")),Object(U.f)("div",{style:{textTransform:"none"}},s.has("org:write")?Object(U.f)(S.a,{items:i,onChange:this.handleQueryUpdate,onSelect:this.handleProjectSelected,emptyMessage:Object(P.b)("No projects")},(function(t){var e=t.isOpen;return Object(U.f)(z.a,{isOpen:e,size:"xsmall"},Object(P.b)("Add Project"))})):Object(U.f)(z.a,{disabled:!0,title:Object(P.b)("You do not have enough permission to associate a project."),size:"xsmall"},Object(P.b)("Add Project")))),Object(U.f)(O.c,null,this.projectPanelContents(n))),Object(U.f)(w.a,c()({pageLinks:this.state.pageLinks},this.props)))}}]),r}(v.a.Component);W.displayName="TeamProjects";var J=Object(m.a)((function(t){return Object(U.f)(q.a,c()({},t,{src:"icon-circle-subtract"}),Object(P.b)("Remove"))}),{target:"eqsa6vb0",label:"RemoveIcon"})("min-height:1.25em;min-width:1.25em;margin-right:",Object(D.a)(1),";"),M=Object(m.a)(O.f,{target:"eqsa6vb1",label:"StyledPanelItem"})("display:flex;align-items:center;justify-content:space-between;padding:",Object(D.a)(2),";"),Q=Object(m.a)("div",{target:"eqsa6vb2",label:"ProjectListElement"})("padding:",Object(D.a)(.25)," 0;");e.default=Object(C.a)(Object(N.a)(W))}}]);
//# sourceMappingURL=TeamProjects.js.map